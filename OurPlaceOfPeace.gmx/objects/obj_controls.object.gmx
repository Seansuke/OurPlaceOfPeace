<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_joy</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// init
// v_plyr = current player number;

v_type = "Keyboard";
v_text[0] = "";
v_text[1] = "";
v_text[2] = "";
v_currentKey = 0;
v_timer = 0;
v_on = false;
depth = -999;
for(i=1;i&lt;BTN_MAX;i+=1)
{
    ctrls[i] = 0;
}
alarm[1] = 3;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>v_text[0] = "Set";
v_text[1] = "Player " + str(v_plyr);
v_text[2] = "Controls";
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>selection timer</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/* Decrease the check timer */
v_timer -= 1;

/* Exit if not on or timer is not run yet */
if(v_on == false || v_timer &gt; 0)
{
    exit;
}

global.menu = true;//keep menu up

/* Draw text relative to current key */
switch(v_currentKey)
{
    case BTN_UP:
        v_text = "PRESS UP KEY";
    break;
    case BTN_RIGHT:
        v_text = "PRESS RIGHT KEY";
    break;
    case BTN_DOWN:
        v_text = "PRESS DOWN KEY";
    break;
    case BTN_LEFT:
        v_text = "PRESS LEFT KEY";
    break;
    case BTN_ATTACK:
        v_text = "PRESS ATTACK KEY";
    break;
    case BTN_GUARD:
        v_text = "PRESS GUARD KEY";
    break;
    case BTN_ARTES1:
        v_text = "PRESS ARTES 1 KEY";
    break;
    case BTN_ARTES2:
        v_text = "PRESS ARTES 2 KEY";
    break;
    case BTN_TARGET:
        v_text = "PRESS TARGET KEY";
    break;
    case BTN_ACTION:
        v_text = "PRESS ACTION KEY";
    break;
    case BTN_MENU:
        v_text = "PRESS MENU KEY";
    break;
}

/* Set Key */
switch(v_type)
{
    case "Keyboard":
        ctrls[v_currentKey] = keyboard_key;
        
        /* Check if keyboard key is even pressed */
        if(ctrls[v_currentKey] != 0)
        {
            /* if a later key, ensure the key is not a copy of the previous key */
            if(v_currentKey == BTN_UP || (v_currentKey != BTN_UP &amp;&amp; ctrls[v_currentKey] != ctrls[v_currentKey - 1]))
            {
                v_currentKey += 1;
                v_timer = 5;
            }
        }
    break;
    case "Gamepad1":
        /* Cycle through joystick buttons to see if any are pressed */
        for(i = 1;i &lt;= joystick_buttons(1);i += 1)
        {
            if(joystick_check_button(1,i) == true &amp;&amp; alarm[0] &lt; 0)
            {
                /* if a later key, ensure the key is not a copy of the previous key */
                if(v_currentKey == BTN_ATTACK || (v_currentKey != BTN_ATTACK &amp;&amp; i != ctrls[v_currentKey - 1]))
                {
                    ctrls[v_currentKey] = i;
                    v_currentKey += 1;
                    v_timer = 5;
                    i = joystick_buttons(1);
                    alarm[0] = 3;
                }
            }
        }
    break;
    case "Gamepad2":
        /* Cycle through joystick buttons to see if any are pressed */
        for(i = 1;i &lt; joystick_buttons(2) + 1;i += 1)
        {
            if(joystick_check_button(2,i) == true &amp;&amp; alarm[0] &lt; 0)
            {
                /* if a later key, ensure the key is not a copy of the previous key */
                if(v_currentKey == BTN_ATTACK || (v_currentKey != BTN_ATTACK &amp;&amp; i != ctrls[v_currentKey - 1]))
                {
                    ctrls[v_currentKey] = i;
                    v_currentKey += 1;
                    v_timer = 5;
                    i = joystick_buttons(2);
                    alarm[0] = 3;
                }
            }
        }
    break;
}
/* if keys are completed, finish up */
if(v_currentKey &gt;= BTN_MAX)
{
    /* Set the newly placed controls into the global array */
    ctrl_new(v_plyr,v_type,
        ctrls[BTN_UP],ctrls[BTN_RIGHT],ctrls[BTN_DOWN],ctrls[BTN_LEFT],
        ctrls[BTN_ATTACK],ctrls[BTN_GUARD],ctrls[BTN_ARTES1],ctrls[BTN_ARTES2],
        ctrls[BTN_TARGET],ctrls[BTN_ACTION],ctrls[BTN_MENU]);   
    /* Reset data */
    v_type = "";
    v_text = "";
    v_currentKey = 0;
    v_timer = 0;
    v_on = false;
    for(i=BTN_UP;i&lt;BTN_MAX;i+=1)
    {
        ctrls[i] = 0;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>types[0] = "Keyboard";
types[1] = "Gamepad1";
types[2] = "Gamepad2";

for(i=0;i &lt; 3;i+=1) {
    if(types[i] == v_type) {
        v_type = types[i + 1 mod 3];
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/* ensure ctrl set begins working */
v_on = true;

/* Begin setting keys, different for gamepad than for keyboard*/
if(v_type == "Keyboard")
{
    v_currentKey = BTN_UP;
}
else
{
    v_currentKey = BTN_ATTACK;
}

/* turn on the timer */
v_timer = 5;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>switch(ctrl_get(v_plyr,BTN_TYPE))
{
    case "n/a":
        draw_sprite(spr_icon,0,x,y);
    break;
    case "Keyboard":
        draw_sprite(spr_key,0,x,y);
    break;
    default:
        draw_sprite(spr_joy,0,x,y);
    break;
}
for(i=0;i&lt;3;i+=1) {
    draw_bold_text(x, y-16 + i*16,v_text[i],c_white,c_black);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
